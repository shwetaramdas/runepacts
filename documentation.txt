Welcome to the runepacts wiki!

RunEpacts is designed to prepare and/or submit datasets for rare variant association, and to present results from said tests in a format that's easy to interpret visually. 
RunEpacts consists of 2 scripts --a Python script and an R script. 

RunEpacts generates a PDF file containing QQ plots and Manhattan plots for the groupwise tests, for the groupwise tests with filtered groups (using only those genes that fit criteria of minimum numbers of variants/minor allele counts), and single-marker results for those significant genes (those genes that meet the p-value cutoff--default is 0.05)

Uses:


Running Runepacts:
Input files:
1. Compulsory files:
-Config file: Specifies parameters and directories
-VCF file: Can be annotated/unannotated
-PED file: Sample information files

2. Optional files:
-Annotation file: Allows users to create non-standard groups of variants
-Groupfile: Pre-created group file in the EPACTS format, if this exists
-Gene list file: File that restricts analysis to a list of genes/groups

File formats:
Config file: There are two columns per line, the first being the parameter name and the second the parameter value. The following are the parameters accepted:

Directories:
INPUTDIR    Directory where input files are found. Can be local path from the folder containing the python script, or global path [COMPULSORY]
EPACTSDIR   Directory from which epacts should be run. If not set, the script assumes epacts is in the path. [OPTIONAL]
OUTPREFIX   Directory where results and output files are written.

Files:
VCFFILE     Vcf file name. Should be present in the INPUTDIR [COMPULSORY]
PEDFILE     File containing sample information. Header compulsory. The first five columns have to be Fam_ID,IND_ID,FAT_ID,MOT_ID,SEX respectively. [COMPULSORY]
ANNOTFILE   Variant-wise annotation file, with the first column containing the variant, and the fifth column containing the gene name (group) [OPTIONAL]
GROUPFILE   [OPTIONAL]
KINSHIPFILE Sample Kinship file used for EMMAX. If not provided, the script will use EPACTS to generate a kinship file. [OPTIONAL]
MAFFILE     File containing MAF information. This is not recommended, since filtering samples may [OPTIONAL]
Tests to run:
MODEL       The phenotype with (if any) covariates to be used. The format is: Phenotype ~ Covariate1+ Covariate2 . The ped file should have a column for the phenotype and each of the covariates.  [COMPULSORY]
TEST        Which test to run. Example: group=skat [COMPULSORY]

Filtering parameters:
FILTERPED   An expression that allows you to filter samples using one of the columns in the PEDFILE [OPTIONAL]
FILTERMAF   This can either be used as a MAF filter (example 0.05), or an expression that allows filtering of the MAF file (example:  'COLUMN1 < 0.001')[OPTIONAL]
FILTERANNOT [OPTIONAL]
MINVARS     Specify the minimum number of variants a gene must have for it to be included in the output [OPTIONAL]
GENEMINMAC  Specify the minimum number of minor alleles a gene must have [OPTIONAL]
PVALUETHRESHOLD What p-value cut-off from the group-wise test should be used to classify a gene as significant? Default = 0.05 [OPTIONAL]

Example config file
EPACTSDIR /net/fantasia/home/hmkang/bin/epactsTest/bin
INPUTDIR	/net/snowwhite/home/sramdas/final.testing/fullvcf
VCFFILE	wave2.clean.vcf.gz
PEDFILE	Wave3_28feb2013_transformations_allexomes_cleanVCF_exclethnicrelated_n9960_alltraits_w_mega10PCs.ped
ANNOTFILE	w2.var.merged.tsv.gz
PEDCOLUMNS	FAM_ID,IND_ID,FAT_ID,MOT_ID,SEX,LDLcalexcmed_ALL_RAW_INV,C1,C2,C3,C4,C5,C6,C7,C8,C9,C10
OUTPREFIX	outputfullvcf.onetestonly.july23/W3.skat.pcs.sex
MODEL	LDLcalexcmed_ALL_RAW_INV ~ SEX + C1 +C2 + C3 + C4 + C5 + C6 + C7 + C8 + C9 + C10
PVALUETHRESHOLD	0.01
FILTERANNOT	MOST_DEL_SCORE < 3
SINGLEMARKERTEST	q.linear
ANNOTCOLUMNS	VEP_TAG
GROUPFILE	W3.skat.pcs.sex_groups.txt
MINVARS	2
GENEMINMAC	5
TEST	group=skat
PROCESS



To run:
> python testrunepacts.py --config configfile.txt

Run time:
